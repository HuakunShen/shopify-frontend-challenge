{"version":3,"sources":["App.jsx","reportWebVitals.js","index.js"],"names":["pmdbapi_key","window","Clipboard","document","navigator","textArea","selectText","range","selection","userAgent","match","createRange","selectNodeContents","getSelection","removeAllRanges","addRange","setSelectionRange","select","copy","text","createElement","value","body","appendChild","createTextArea","execCommand","removeChild","MovieCard","movie","className","src","Poster","alt","Title","Year","imdbID","App","useState","searchTerm","setSearchTerm","movies","setMovies","msg","setMsg","msgErr","setMsgErr","nominated","setNominated","initLocalStorageLoaded","setInitLocalStorageLoaded","msgTimeoutID","setMsgTimeoutID","setMessage","err","time","delay","clearTimeout","setTimeout","searchById","id","Promise","resolve","reject","fetch","then","res","json","result","Response","Error","error","loadFromIds","ids","promises","forEach","idx","a","push","all","results","catch","useEffect","location","pathname","urlParams","URLSearchParams","search","get","length","split","localStorage","getItem","setItem","map","join","size","Search","removeOnClick","e","element","target","parentElement","$","addClass","children","filter","m","isNominated","i","data-toggle","data-placement","title","onClick","id_arr","set","share_link","origin","toString","rel","href","htmlFor","type","placeholder","onChange","role","disabled","console","log","nominateOnCLick","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.7000e90c.chunk.js","sourcesContent":["import { useState, useEffect } from 'react';\nimport './App.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport $ from 'jquery';\n\nconst pmdbapi_key = '1583369f';\nconst nominate_size = 5;\n\nwindow.Clipboard = (function (window, document, navigator) {\n  var textArea, copy;\n\n  function isOS() {\n    return navigator.userAgent.match(/ipad|iphone/i);\n  }\n\n  function createTextArea(text) {\n    textArea = document.createElement('textArea');\n    textArea.value = text;\n    document.body.appendChild(textArea);\n  }\n\n  function selectText() {\n    var range, selection;\n\n    if (isOS()) {\n      range = document.createRange();\n      range.selectNodeContents(textArea);\n      selection = window.getSelection();\n      selection.removeAllRanges();\n      selection.addRange(range);\n      textArea.setSelectionRange(0, 999999);\n    } else {\n      textArea.select();\n    }\n  }\n\n  function copyToClipboard() {\n    document.execCommand('copy');\n    document.body.removeChild(textArea);\n  }\n\n  copy = function (text) {\n    createTextArea(text);\n    selectText();\n    copyToClipboard();\n  };\n\n  return {\n    copy: copy,\n  };\n})(window, document, navigator);\n\nconst MovieCard = ({ movie }) => {\n  return (\n    <div className='movie-info'>\n      <div className='row'>\n        <div className='col-lg-4'>\n          <img\n            className='movie-poster'\n            src={movie.Poster === 'N/A' ? 'not_available.png' : movie.Poster}\n            alt=''\n          />\n        </div>\n        <div className='col-lg-8'>\n          <p>\n            <strong>Title:</strong> {`${movie.Title}`}\n          </p>\n          <p>\n            <strong>Year:</strong> {`${movie.Year}`}\n          </p>\n          <p>\n            <strong>imdb ID:</strong> {`${movie.imdbID}`}\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nfunction App() {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [movies, setMovies] = useState([]);\n  // const [nominateStatus, setNominateStatus] = useState([]);\n  const [msg, setMsg] = useState('');\n  const [msgErr, setMsgErr] = useState(false);\n  const [nominated, setNominated] = useState([]);\n  const [initLocalStorageLoaded, setInitLocalStorageLoaded] = useState(false);\n  const [msgTimeoutID, setMsgTimeoutID] = useState(null);\n  // message banner helper function\n  const setMessage = (msg, err, time) => {\n    const delay = time || 3000;\n    setMsg(msg);\n    setMsgErr(err);\n    if (msgTimeoutID) {\n      clearTimeout(msgTimeoutID);\n    }\n    setMsgTimeoutID(\n      setTimeout(() => {\n        setMsg('');\n      }, delay)\n    );\n  };\n\n  // ============================================= helpers for loading movie info from api =============================================\n  const searchByTitle = () => {\n    return new Promise((resolve, reject) => {\n      fetch(`https://www.omdbapi.com/?s=${searchTerm}&apikey=${pmdbapi_key}`)\n        .then((res) => res.json())\n        .then(\n          (result) => {\n            if (result.Response === 'True') {\n              resolve(result.Search);\n            } else {\n              reject(result.Error);\n            }\n          },\n          (error) => {\n            reject(error);\n          }\n        );\n    });\n  };\n\n  const searchById = (id) => {\n    return new Promise((resolve, reject) => {\n      fetch(`https://www.omdbapi.com/?i=${id}&apikey=${pmdbapi_key}`)\n        .then((res) => res.json())\n        .then(\n          (result) => {\n            if (result.Response === 'True') {\n              resolve(result);\n            } else {\n              reject(result.Error);\n            }\n          },\n          (error) => {\n            reject(error);\n          }\n        );\n    });\n  };\n\n  const loadFromIds = (ids) => {\n    const promises = [];\n    ids.forEach(async (id, idx) => {\n      if (idx >= nominate_size) {\n        setMessage(\n          `Error: Your share line contains more than ${nominate_size} movies, only 5 will be loaded`,\n          true,\n          5000\n        );\n      } else {\n        promises.push(searchById(id));\n      }\n    });\n    Promise.all(promises)\n      .then((results) => {\n        setNominated(results);\n      })\n      .catch((err) => {\n        setMessage(`Error: Got error while loading shared movies. ${err}`);\n      });\n  };\n\n  // ======================================== on vairable change and component init ========================================\n  useEffect(() => {\n    // process share link\n    if (window.location.pathname === '/share') {\n      const urlParams = new URLSearchParams(window.location.search);\n      const ids_str = urlParams.get('ids');\n      if (ids_str.length === 0) {\n        setMessage('Error: Share Link has no content', true, 5000);\n      }\n      const ids = urlParams.get('ids').split(',');\n      // load the movies\n      loadFromIds(ids);\n    } else if (localStorage.getItem('movie_ids')) {\n      const ids = localStorage.getItem('movie_ids').split(',');\n      loadFromIds(ids);\n    }\n    // eslint-disable-next-line\n  }, []);\n\n  // whenever nomination list changes, save a copy of their ids to localStorage.\n  useEffect(() => {\n    if (initLocalStorageLoaded) {\n      localStorage.setItem(\n        'movie_ids',\n        nominated.map((movie) => movie.imdbID).join(',')\n      );\n      if (nominated.size === nominate_size) {\n        setMessage(\n          `${nominate_size} movies are nominated, you reached the limit`,\n          false\n        );\n      }\n    } else {\n      setInitLocalStorageLoaded(true);\n    }\n    // eslint-disable-next-line\n  }, [nominated, initLocalStorageLoaded]);\n\n  // When input (searchTerm) changes, do a search with AP\n  useEffect(() => {\n    if (searchTerm === '') {\n      setMovies([]);\n    } else {\n      searchByTitle()\n        .then((result) => {\n          setMovies(result);\n        })\n        .catch((err) => {\n          setMessage(err, true);\n          setMovies([]);\n        });\n    }\n    // eslint-disable-next-line\n  }, [searchTerm]);\n\n  // ============================================= onClick events =============================================\n  const nominateOnCLick = (idx, movie) => {\n    console.log('click nominate');\n    if (isNominated(movie)) {\n      setMessage(\n        \"Error: Invalid Click on Nominate Button (Shouldnn't be able to click)\",\n        true\n      );\n    } else {\n      if (nominated.length >= nominate_size) {\n        setMessage(\n          `You reach the max nomination limit: ${nominate_size}`,\n          true\n        );\n      } else {\n        setNominated([...nominated, movie]);\n      }\n    }\n  };\n\n  const removeAnimation = (element) => {\n    $(element).addClass('removing');\n    $(element).children('*').addClass('removing');\n  };\n\n  const removeOnClick = (e, movie) => {\n    removeAnimation(e.target.parentElement);\n    setTimeout(() => {\n      setNominated(nominated.filter((m) => m.imdbID !== movie.imdbID));\n    }, 850);\n  };\n\n  const shareOnClick = (e) => {\n    const id_arr = nominated.map((movie) => movie.imdbID);\n    if (id_arr.length === 0) {\n      setMessage('Nothing to Share', true);\n      return;\n    }\n    const urlParams = new URLSearchParams();\n    urlParams.set('ids', id_arr);\n    const share_link = `${\n      window.location.origin\n    }/share?${urlParams.toString()}`;\n    window.Clipboard.copy(share_link);\n    setMessage(\n      `Your share link is generated and saved to your clipboard: ${share_link}`,\n      false,\n      10000\n    );\n  };\n\n  const isNominated = (movie) => {\n    for (let i = 0; i < nominated.length; i++) {\n      if (nominated[i].imdbID === movie.imdbID) return true;\n    }\n    return false;\n  };\n\n  return (\n    <div className='App'>\n      <div className='container pt-5'>\n        <h2 id='title'>The Shoppies</h2>\n\n        <i\n          className='far fa-share-square'\n          data-toggle='tooltip'\n          data-placement='top'\n          title='Share'\n          onClick={shareOnClick}\n        ></i>\n\n        <a\n          id='source-code-link'\n          target='_blank'\n          rel='noreferrer'\n          data-toggle='tooltip'\n          data-placement='top'\n          title='Source Code'\n          href='https://github.com/HuakunShen/shopify-frontend-challenge'\n        >\n          <i className='fas fa-code'></i>\n        </a>\n        <div className='card'>\n          <div className='card-body'>\n            <label htmlFor='search-box'>Movie Title</label>\n            <div className='input-group'>\n              <div className='input-group-prepend'>\n                <button className='btn btn-outline-secondary'>\n                  <i className='fas fa-search'></i>\n                </button>\n              </div>\n\n              <input\n                id='search-box'\n                type='text'\n                value={searchTerm}\n                className='form-control'\n                placeholder='Search'\n                onChange={(e) => setSearchTerm(e.target.value)}\n              />\n            </div>\n          </div>\n        </div>\n        {msg ? (\n          <div\n            className={`alert alert-${\n              msgErr ? 'danger' : 'primary'\n            } mt-3 sticky-top`}\n            role='alert'\n          >\n            {msg}\n          </div>\n        ) : null}\n\n        <div className='row mt-3'>\n          <div className='col-md-6'>\n            <div className='card'>\n              <div id='movie-list' className='card-body'>\n                <h3>Results For {searchTerm ? `\"${searchTerm}\"` : '...'}</h3>\n\n                <ul className='list-group'>\n                  {movies.map((movie, idx) => {\n                    return (\n                      <li\n                        key={idx}\n                        className='list-group-item d-flex justify-content-between align-items-center'\n                      >\n                        {<MovieCard movie={movie} />}\n                        <button\n                          className='btn btn-primary btn-sm'\n                          disabled={isNominated(movie)}\n                          onClick={() => nominateOnCLick(idx, movie)}\n                        >\n                          Nominate\n                        </button>\n                      </li>\n                    );\n                  })}\n                  {movies.length !== 0 ? null : (\n                    <div className='d-flex justify-content-center pt-4'>\n                      <div className='spinner-border' role='status'>\n                        <span className='sr-only'>Loading...</span>\n                      </div>\n                    </div>\n                  )}\n                </ul>\n              </div>\n            </div>\n          </div>\n          <div className='col-md-6'>\n            <div className='card'>\n              <div className='card-body'>\n                <h3>Nominations</h3>\n                <ul className='list-group'>\n                  {nominated.map((movie) => {\n                    return (\n                      <li\n                        key={movie.imdbID}\n                        className='list-group-item d-flex justify-content-between align-items-center'\n                      >\n                        {<MovieCard movie={movie} />}\n                        <button\n                          className='btn btn-danger btn-sm'\n                          disabled={false}\n                          onClick={(e) => removeOnClick(e, movie)}\n                        >\n                          Remove\n                        </button>\n                      </li>\n                    );\n                  })}\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App.jsx';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}